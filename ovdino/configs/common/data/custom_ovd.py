import itertools

import detectron2.data.transforms as T
from detectron2.config import LazyCall as L
from detectron2.data import (
    build_detection_test_loader,
    build_detection_train_loader,
    get_detection_dataset_dicts,
)
from detectron2.evaluation import COCOEvaluator
from detrex.data import DetrDatasetMapper
from detrex.data.datasets import register_custom_ovd_instances
from omegaconf import OmegaConf

dataloader = OmegaConf.create()

# Case 0: If you want to define it by yourself, you can change it on ovdino/detrex/data/datasets/custom_ovd.py, you need to uncomment the code (ovdino/detrex/data/datasets/__init__.py L21) first.
# Case 1 (Recommend): If you follow the coco format, you need uncomment and change the following code.
# 1. Define custom_meta_info, just a example, you need to change it to your own.
meta_info = {
    "thing_dataset_id_to_contiguous_id": {0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7, 8: 8, 9: 9, 10: 10, 11: 11, 12: 12, 13: 13, 14: 14, 15: 15, 16: 16, 17: 17, 18: 18, 19: 19, 20: 20, 21: 21, 22: 22, 23: 23, 24: 24, 25: 25, 26: 26, 27: 27, 28: 28, 29: 29, 30: 30, 31: 31, 32: 32, 33: 33, 34: 34, 35: 35, 36: 36, 37: 37, 38: 38, 39: 39, 40: 40, 41: 41, 42: 42, 43: 43, 44: 44, 45: 45, 46: 46, 47: 47, 48: 48, 49: 49, 50: 50, 51: 51, 52: 52, 53: 53, 54: 54, 55: 55, 56: 56, 57: 57, 58: 58, 59: 59, 60: 60, 61: 61, 62: 62, 63: 63, 64: 64, 65: 65, 66: 66, 67: 67, 68: 68, 69: 69, 70: 70, 71: 71, 72: 72, 73: 73, 74: 74, 75: 75, 76: 76, 77: 77, 78: 78, 79: 79, 80: 80, 81: 81, 82: 82, 83: 83, 84: 84, 85: 85, 86: 86, 87: 87, 88: 88, 89: 89, 90: 90, 91: 91, 92: 92, 93: 93, 94: 94, 95: 95, 96: 96, 97: 97, 98: 98, 99: 99, 100: 100, 101: 101, 102: 102, 103: 103, 104: 104, 105: 105, 106: 106, 107: 107, 108: 108, 109: 109, 110: 110, 111: 111, 112: 112, 113: 113, 114: 114, 115: 115, 116: 116, 117: 117, 118: 118, 119: 119, 120: 120, 121: 121, 122: 122, 123: 123, 124: 124, 125: 125, 126: 126, 127: 127, 128: 128, 129: 129, 130: 130, 131: 131, 132: 132, 133: 133, 134: 134, 135: 135, 136: 136, 137: 137, 138: 138, 139: 139, 140: 140, 141: 141, 142: 142, 143: 143, 144: 144, 145: 145, 146: 146, 147: 147, 148: 148, 149: 149, 150: 150, 151: 151, 152: 152, 153: 153, 154: 154, 155: 155, 156: 156, 157: 157, 158: 158, 159: 159, 160: 160, 161: 161, 162: 162, 163: 163, 164: 164, 165: 165, 166: 166, 167: 167, 168: 168, 169: 169, 170: 170, 171: 171, 172: 172, 173: 173, 174: 174, 175: 175, 176: 176, 177: 177, 178: 178, 179: 179, 180: 180, 181: 181, 182: 182, 183: 183, 184: 184, 185: 185, 186: 186, 187: 187, 188: 188, 189: 189, 190: 190, 191: 191, 192: 192, 193: 193, 194: 194, 195: 195, 196: 196, 197: 197, 198: 198, 199: 199, 200: 200, 201: 201, 202: 202, 203: 203, 204: 204, 205: 205, 206: 206, 207: 207, 208: 208, 209: 209, 210: 210, 211: 211, 212: 212, 213: 213, 214: 214, 215: 215, 216: 216, 217: 217, 218: 218, 219: 219, 220: 220, 221: 221, 223: 222, 224: 223, 225: 224, 226: 225, 227: 226, 228: 227, 229: 228, 230: 229, 231: 230, 232: 231, 233: 232, 234: 233, 235: 234, 236: 235, 237: 236, 238: 237, 239: 238, 240: 239, 241: 240, 242: 241, 243: 242, 244: 243, 245: 244, 246: 245, 247: 246, 248: 247, 249: 248, 250: 249, 251: 250, 252: 251, 253: 252, 254: 253, 255: 254, 256: 255, 257: 256, 258: 257, 259: 258, 260: 259, 261: 260, 262: 261, 263: 262, 264: 263, 265: 264, 266: 265, 267: 266, 268: 267, 269: 268, 270: 269, 271: 270, 272: 271, 273: 272, 274: 273, 275: 274, 276: 275, 277: 276, 278: 277, 279: 278, 280: 279, 281: 280, 282: 281, 283: 282, 284: 283, 285: 284, 286: 285, 287: 286, 288: 287, 289: 288, 290: 289, 291: 290, 292: 291, 293: 292, 294: 293, 295: 294, 296: 295, 297: 296, 298: 297, 299: 298, 300: 299, 301: 300, 302: 301, 303: 302, 304: 303, 305: 304, 306: 305, 307: 306, 308: 307, 309: 308, 310: 309, 311: 310, 312: 311, 313: 312, 314: 313, 315: 314, 316: 315, 317: 316, 318: 317, 319: 318, 320: 319, 321: 320, 322: 321, 323: 322, 324: 323, 325: 324, 326: 325, 327: 326, 328: 327, 329: 328, 330: 329, 331: 330, 332: 331, 333: 332, 334: 333, 335: 334, 336: 335, 337: 336, 338: 337, 339: 338, 340: 339, 341: 340, 342: 341, 343: 342, 344: 343, 345: 344, 346: 345, 347: 346, 348: 347, 349: 348, 350: 349, 351: 350, 352: 351, 353: 352, 354: 353, 355: 354, 356: 355, 357: 356, 358: 357, 359: 358, 360: 359, 361: 360, 362: 361, 363: 362, 364: 363, 365: 364, 366: 365, 367: 366, 368: 367, 369: 368, 370: 369, 371: 370, 372: 371, 373: 372, 374: 373, 375: 374, 376: 375, 377: 376, 378: 377, 379: 378, 380: 379, 381: 380, 382: 381, 383: 382, 384: 383, 385: 384, 386: 385, 387: 386, 388: 387, 389: 388, 390: 389, 391: 390, 392: 391, 393: 392, 394: 393, 395: 394, 396: 395, 397: 396, 398: 397, 399: 398, 400: 399, 401: 400, 402: 401, 403: 402, 404: 403, 405: 404, 406: 405, 407: 406, 408: 407, 409: 408, 410: 409, 411: 410, 412: 411, 413: 412, 414: 413, 415: 414, 416: 415, 417: 416, 418: 417, 419: 418, 420: 419, 421: 420, 422: 421, 423: 422, 424: 423, 425: 424, 426: 425, 427: 426, 428: 427, 429: 428, 430: 429, 431: 430, 432: 431, 433: 432, 434: 433, 435: 434, 436: 435, 437: 436, 438: 437, 439: 438, 440: 439, 441: 440, 442: 441, 443: 442, 444: 443, 445: 444, 446: 445, 447: 446, 448: 447, 449: 448, 450: 449, 451: 450, 452: 451, 453: 452, 454: 453, 455: 454, 456: 455, 457: 456, 458: 457, 459: 458, 460: 459, 461: 460, 462: 461, 463: 462, 464: 463, 465: 464, 466: 465, 467: 466, 468: 467, 469: 468, 470: 469, 471: 470, 472: 471, 473: 472, 474: 473, 475: 474, 476: 475, 477: 476, 478: 477, 479: 478, 480: 479, 481: 480, 482: 481, 483: 482, 484: 483, 485: 484, 486: 485, 487: 486, 488: 487, 489: 488, 490: 489, 491: 490, 492: 491, 493: 492, 494: 493, 495: 494, 496: 495, 497: 496, 498: 497, 499: 498, 500: 499, 501: 500, 502: 501, 503: 502, 504: 503, 505: 504, 506: 505, 507: 506, 508: 507, 509: 508, 510: 509, 511: 510, 512: 511, 513: 512, 514: 513, 515: 514, 516: 515, 517: 516, 518: 517, 519: 518, 520: 519, 521: 520, 522: 521, 523: 522, 524: 523, 525: 524, 526: 525, 527: 526, 528: 527, 529: 528, 530: 529, 531: 530, 532: 531, 533: 532, 534: 533, 535: 534, 536: 535, 537: 536, 538: 537, 539: 538, 540: 539, 541: 540, 542: 541, 543: 542, 544: 543, 545: 544, 546: 545, 547: 546, 548: 547, 549: 548, 550: 549, 551: 550, 552: 551, 553: 552, 554: 553, 555: 554, 556: 555, 557: 556, 558: 557, 559: 558, 560: 559, 561: 560, 562: 561, 563: 562, 564: 563, 565: 564, 566: 565, 567: 566, 568: 567, 569: 568, 570: 569, 571: 570, 572: 571, 573: 572, 574: 573, 575: 574, 576: 575, 577: 576, 578: 577, 579: 578, 580: 579, 581: 580, 582: 581, 583: 582, 584: 583, 585: 584, 586: 585, 587: 586, 588: 587, 589: 588, 590: 589, 591: 590, 592: 591, 593: 592, 594: 593, 595: 594, 596: 595, 597: 596, 598: 597, 599: 598, 600: 599, 601: 600, 602: 601, 603: 602, 604: 603, 605: 604, 606: 605, 607: 606, 608: 607, 609: 608, 610: 609, 611: 610, 612: 611, 613: 612, 614: 613, 615: 614, 616: 615, 617: 616, 618: 617, 619: 618, 620: 619, 621: 620, 622: 621, 623: 622, 624: 623, 625: 624, 626: 625, 627: 626, 628: 627, 629: 628, 630: 629, 631: 630, 632: 631, 633: 632, 634: 633, 635: 634, 636: 635, 637: 636, 638: 637, 639: 638, 640: 639, 641: 640, 642: 641, 643: 642, 644: 643, 645: 644, 646: 645, 647: 646, 648: 647, 649: 648, 650: 649, 651: 650, 652: 651, 653: 652, 654: 653, 655: 654, 656: 655, 657: 656, 658: 657, 659: 658, 660: 659, 661: 660, 662: 661, 663: 662, 664: 663, 665: 664, 666: 665, 667: 666, 668: 667, 669: 668, 670: 669, 671: 670, 672: 671, 673: 672, 674: 673, 675: 674, 676: 675, 677: 676, 678: 677, 679: 678, 680: 679, 681: 680, 682: 681, 683: 682, 684: 683, 685: 684, 686: 685, 687: 686, 688: 687, 689: 688, 690: 689, 691: 690, 692: 691, 693: 692, 694: 693, 695: 694, 696: 695, 697: 696, 698: 697, 699: 698, 700: 699, 701: 700, 702: 701, 703: 702, 704: 703, 705: 704, 706: 705, 707: 706, 708: 707, 709: 708, 710: 709, 711: 710, 712: 711, 713: 712, 714: 713, 715: 714, 716: 715, 717: 716, 718: 717, 719: 718, 720: 719, 721: 720, 722: 721, 723: 722, 724: 723, 725: 724, 726: 725, 727: 726, 728: 727, 729: 728, 730: 729, 731: 730, 732: 731, 733: 732, 734: 733, 735: 734, 736: 735, 737: 736, 738: 737, 739: 738, 740: 739, 741: 740, 742: 741, 743: 742, 744: 743, 745: 744, 746: 745, 747: 746, 748: 747, 749: 748, 750: 749, 751: 750, 752: 751, 753: 752, 754: 753, 755: 754, 756: 755, 757: 756, 758: 757, 759: 758, 760: 759, 761: 760, 762: 761, 763: 762, 764: 763, 765: 764, 766: 765, 767: 766, 768: 767, 769: 768, 770: 769, 771: 770, 772: 771, 773: 772, 774: 773, 775: 774, 776: 775, 777: 776, 778: 777, 779: 778, 780: 779, 781: 780, 782: 781, 783: 782, 784: 783, 785: 784, 786: 785, 787: 786, 788: 787, 789: 788, 790: 789, 791: 790, 792: 791, 793: 792, 794: 793, 795: 794, 796: 795, 797: 796, 798: 797, 799: 798, 800: 799, 801: 800, 802: 801, 803: 802, 804: 803, 805: 804, 806: 805, 807: 806, 808: 807, 809: 808, 810: 809, 811: 810, 812: 811, 813: 812, 814: 813, 815: 814, 816: 815, 817: 816, 818: 817, 819: 818, 820: 819, 821: 820, 822: 821, 823: 822, 824: 823, 825: 824, 826: 825, 827: 826, 828: 827, 829: 828, 830: 829, 831: 830, 832: 831, 833: 832, 834: 833, 835: 834, 836: 835, 837: 836, 838: 837, 839: 838, 840: 839, 841: 840, 842: 841, 843: 842, 844: 843, 845: 844, 846: 845, 847: 846, 848: 847, 849: 848, 850: 849, 851: 850, 852: 851, 853: 852, 854: 853, 855: 854, 856: 855, 857: 856, 858: 857, 859: 858, 860: 859, 861: 860, 862: 861, 863: 862, 864: 863, 865: 864, 866: 865, 867: 866, 868: 867, 869: 868, 870: 869, 871: 870, 872: 871, 873: 872, 874: 873, 875: 874, 876: 875, 877: 876, 878: 877, 879: 878, 880: 879, 881: 880, 882: 881, 883: 882, 884: 883, 885: 884, 886: 885, 887: 886, 888: 887, 889: 888, 890: 889, 891: 890, 892: 891, 893: 892, 894: 893, 895: 894, 896: 895, 897: 896, 898: 897, 899: 898, 900: 899, 901: 900, 902: 901, 903: 902, 904: 903, 905: 904, 906: 905, 907: 906, 908: 907, 909: 908, 910: 909, 911: 910, 912: 911, 913: 912, 914: 913, 915: 914, 916: 915, 917: 916, 918: 917, 919: 918, 920: 919, 921: 920, 922: 921, 923: 922, 924: 923, 925: 924, 926: 925, 927: 926, 928: 927, 929: 928, 930: 929, 931: 930, 932: 931, 933: 932, 934: 933, 935: 934, 936: 935, 937: 936, 938: 937, 939: 938, 940: 939, 941: 940, 942: 941, 943: 942, 944: 943, 945: 944, 946: 945, 947: 946, 948: 947, 949: 948, 950: 949, 951: 950, 952: 951, 953: 952, 954: 953, 955: 954, 956: 955, 957: 956, 958: 957, 959: 958},
    "thing_classes": ['1664_beer', '2205_duplex_stainless_steel', '304_stainless_steel_board', '316_stainless_steel_pipe', '3D_Printer', '3D_scanner', '3D_stereo_mask', '3D_stereo_craft_commemorative_coins', '45-degree_elbow', '5100_Tibet_glacier_mineral_water', '90_degree_elbow', '92_Type_police_pistol', 'A_O_integrated_sewage_treatment_equipment', 'A_O_method_(anaerobic-aerobic)_buried_sewage_treatment_equipment', 'A-10_Thunder_attack_aircraft_model', 'A-Ha_fermented_juice_apple_flavored_sparkling_water', 'AC-DC_power_supply_module', 'AC-DC_power_supply_module', 'AED', 'AGV_car', 'APP_modified_asphalt_roll', 'AR_head_display', 'AR_glasses', 'A_type_power_adapter_plug', 'A_type_ultrasonic_diagnostic_instrument', 'A-shaped_skirt', 'A-shaped_dress', 'A-line_long_skirt', 'B-2_stealth_bomber_model', 'BB_cream', 'BD-R_write-once_optical_disc', 'BRAGG_apple_vinegar', 'B-type_power_adapter_plug', 'B_type_ultrasonic_diagnostic_instrument', 'C2-type_storage_cage', 'CCD_scanner', 'CC_cream', 'CD-I_read-only_disc', 'CD-ROM_read-only_optical_disc', 'CD-R_write-once_disc', 'CD-V_read-only_disc', 'CD-RW_rewritable_optical_disc', 'CD-R_write-once_optical_disc', 'CIS_scanner', 'CO2_detector', 'COD_online_monitor', 'COD_detector', 'CO₂_incubator', 'CPVC_hot_water_pipe', 'CPVC_water_pipe', 'CT_scanner', 'C-type_clamp_ring', 'C_type_ultrasonic_imager', 'DC-DC_power_module', 'DC-DC_power_supply', 'DC-DC_adapter', 'DC-DC_power_module', 'DC-DC_direct_current_power_supply', 'DC-DC_adapter', 'DNA_sequencer', 'DVD-ROM_read-only_disc', 'DVD-RW_rewritable_optical_disc', 'DVD-RW_rewritable_optical_disc', 'DVD-R_write-once_optical_disc', 'D-type_power_adapter_plug', 'D-type_ultra-thin_Acoustic_Doppler_diagnostic_instrument', 'D-shaped_ring', 'EVA_mat_anti-static_workbench', 'EVA_resin_yoga_bricks', 'Type_E_power_adapter_plug', 'F-16_fighter_model', 'F-22_Raptor_model', 'FDM3D_Printer', 'FIJI_Water_natural_mineral_water', 'FRP_drain_pipe', 'FRP_pipes', 'F-type_clip', 'F-type_power_adapter_plug', 'GPD_handheld_game_console', 'GPS_positioning_pet_collar', 'G_type_power_adapter_plug', 'HD_DVD-R_write-once_optical_disc', 'HDPE_waterproof_membrane', 'Heinz_Heinz_ketchup', 'Heinz_ketchup', 'H-shaped_steel', 'H-shaped_tube_ultraviolet_sterilization_lamp', 'IDE_interface_mechanical_hard_disk', 'IPL_intense_pulsed_light_hair_removal_device', 'IPS_panel_concave_display', 'I-type_power_adapter_plug', 'J-type_power_adapter_plug', 'KP95_anti-oil_fume_mask', 'LCDAR_projector', 'LCD_screen_tablet', 'LED_digital_wall_clock', 'LED_tube_light', 'LED_lighting_toys', 'LED_tattoo_lamp', 'LED_beauty_lamp', 'L-shaped_computer_desk', 'L-shaped_sofa', 'M.2_solid_state_drive', 'MBBR_integrated_sewage_treatment_equipment', 'MBR_integrated_sewage_treatment_equipment', 'MP3', 'MP4', 'McCormick_McCormick_ketchup', 'M-type_ultrasonic_diagnostic_instrument', 'N95_mask', 'OLED_screen_tablet', 'OLED_screen_straight_phone', 'O-ring', 'PCIe_expansion_card_solid_state_drive', 'PCVR_headset', 'PET_anti-static_film', 'PE_drainage_pipe', 'PE_foam_membrane', 'PE_foam_board', 'PE_dishwashing_gloves', 'PE_gas_pipe', 'PE_tube_welding_glue', 'PE_water_pipe', 'PE_fishing_line', 'PG_VG_Mixed_smoke_oil', 'PG_VG_mixed_smoke_oil', 'PH_value_meter', 'PLC_control_cabinet', 'PM10_detector', 'PM2.5_detector', 'POS_machine', 'PP-B_tube', 'PP-RP_tube', 'PP-R_tube', 'PPB_tube', 'PP-RP_pipe', 'PP_cotton_filter', 'PP_cotton_filter_water_purifier', 'PT_stool', 'PT_bed', 'PU_air_pipe', 'PU_anti-static_shoes', 'PVC_plastic_wrap', 'PVC_roller_shutter_door', 'PVC_plugging_tape', 'PVC_wallpaper', 'PVC_folding_bathtub', 'PVC_drainage_pipe', 'PVC_air_pipe', 'PVC_water_hose', 'PVC_dishwashing_gloves', 'PVC_cleaning_gloves', 'PVC_wire_conduit', 'PVC_cable_protection_pipe', 'PVC_pipe_glue', 'PVC_wire_pipe', 'PVC_floor-standing_bathroom_cabinet', 'PVC_door_mat', 'PVC_bumper_strip', 'PVC_waterproof_membrane', 'PVC_waterproof_sleeves', 'PVC_anti-static_shoes', 'PVC_heat_insulation_pad', 'PVDC_plastic_wrap', 'R2-D2_doll', 'R2-D2_doll', 'RJ11_crystal_head', 'RJ45_crystal_head', 'ROG_handheld_game_console', 'SAS_interface_mechanical_hard_disk', 'SATA_interface_mechanical_hard_disk', 'SBR_integrated_sewage_treatment_equipment', 'SBR_method_(sequencing_batch_activated_sludge_method)_buried_sewage_treatment_equipment', 'SBS_modified_asphalt_membrane', 'SLA_3D_printer', 'SLS_3D_printer', 'San_Pellegrino_mineral_water', 'S-type_push-up_bracket', 'TDS_detector', 'TPO_waterproof_membrane', 'TPU_folding_bathtub', 'TWS_true_wireless_Bluetooth_headset', 'T-bolt', 'T-shaped_steel', 'T-shirt', 'T-handle_trekking_pole', 'UOSO_fluorescent_bracelet', 'UPS_uninterruptible_power_supply', 'UPVC_folding_window', 'USB_powered_warm_desk_pad', 'USB_socket', 'U_VA_therapy_device', 'UVA_banknote_detector', 'UVB_phototherapy_device', 'UVB_therapeutic_device', 'UVC_therapeutic_device', 'U-shaped_hairpin', 'U-shaped_ordinary_pillow', 'U_disk', 'U-neck_T-shirt', 'VOSS_natural_mineral_water', 'VR_headset', 'V-shaped_mask', 'V-neck_T-shirt', 'V-neck_thermal_underwear', 'V-neck_sweatshirt', 'V-neck_camisole', 'V-neck_jumpsuit', 'V-neck_jumpsuit', 'V-neck_knitted_cardigan', 'V-neck_knitted_sweater', 'V-neck_chiffon_shirt', 'XKJ_fluorescent_bracelet', 'X-ray_machine', 'X-ray_spectrometer', 'X-ray_absorption_spectrometer', 'X-ray_flaw_detector', 'X-ray_fluorescence_spectrometer', 'X-ray_fluorescence_analyzer', 'X-ray_diffractometer', 'Y-type_indwelling_needle', 'Y-type_filter', 'iOS_system_AR_tablet', 'mSATA_solid_state_drive', 'pH_meter', 'sup_handheld_game_console', 'xo_brandy', 'β-ray_detector', 'γ-radiation_dose_rate_meter', 'Integrated_sewage_treatment_device', 'Integrated_sewage_treatment_equipment', 'Integrated_gas_stove', 'Integrated_electric_steamer', 'All-in-one_VR', 'Flat-blade_screwdriver', 'one-shoulder_chiffon_shirt', 'smooth_sailing_hydroponic_potted_plants', 'Write-once_optical_disc', 'Disposable_fresh-keeping_box', 'disposable_Underwear', 'Disposable_gloves', 'Disposable_lighter', 'Disposable_cup', 'disposable_cleaning_gloves', 'disposable_spittoon_cups', 'disposable_protective_clothing', 'disposable_toilet_seats', 'carbon_monoxide_detectors', 'carbon_monoxide_detectors', 'carbon_monoxide_monitors', 'butyl_waterproof_tape', 'T-back_underwear', 'T-shaped_basketball_stand', 'T-shaped_basketball_hoop', 'Dingao_bayberry', 'Nitrile_disposable_gloves', 'Nitrile_cleaning_gloves', '7UP', '7UP_lemon_flavor_bottle', '7UP_lemon_flavor_can', 'Seven-hole_head_tube', 'Seven-string_willow_harp', 'July_red_guava', 'Wansan_elbow', 'Wansanti', 'Universal_ring', 'Halloween_decoration_toys', 'Multimeter', 'Universal_tensile_testing_machine', 'Kaleidoscope_toy', 'Three-in-one_frame_comprehensive_trainer', 'Three-coordinate_measuring_instrument', 'Three-coordinate_measuring_machine', 'Three-layer_soundproof_glass', 'Three-screen_folding_phone', 'Suntory_oolong_tea', 'salmon', 'Salmon_sashimi', 'Sandwich_bread', 'Sanhong_honey_pomelo', 'three-chamber_catheter', 'pansy_potted_plant', 'briefs', 'grand_piano', 'three-legged_goblet', 'three-way', 'three-way_connector', 'three-key_French_horn', 'Three-door_refrigerator', 'Three-door_steam_rice_cabinet', 'three-proof_label_paper', 'three-tone_Hulusi', 'Bunk_bed', 'Shanghai_Taitai_Le_chicken_essence', 'Shanghai_Qing', 'Top', 'Under-hanging_garbage_Processor', 'Bottom-mounted_water_dispenser', 'Corded_fixed-line_phone_without_caller_ID', 'self-adhesive_printing_paper', 'Self-adhesive_label_paper', 'Stainless_steel_scissors', 'Stainless_steel_rolling_door', 'Stainless_steel_kitchen_scissors', 'Stainless_steel_hinges', 'Stainless_steel_washer', 'Stainless_steel_wall-mounted_floor_drain', 'Stainless_steel_composite_pipe', 'Stainless_steel_swing_door', 'Stainless_steel_ring', 'Stainless_steel_manual_meat_grinder', 'Stainless_steel_egg_beater', 'Stainless_steel_wrench_faucet', 'Stainless_steel_ornaments', 'Stainless_steel_sliding_support', 'Stainless_steel_chopsticks', 'Stainless_steel_pipe', 'Stainless_steel_wire_pipe', 'Stainless_steel_wire_ball', 'Stainless_steel_ruler', 'Stainless_steel_partition', 'Stainless_steel_sculptures', 'Stainless_steel_necklace', 'stainless_steel_vibraphone', 'Stainless_steel_food_storage_Box', 'Professional_image_CIS_scanner', 'Professional_multi-function_fax_machine', 'Professional_pet_shaver', 'Professional_broadcast-grade_shoulder-mounted_camcorder', 'professional_hair_clippers', 'Professional_thermal_sublimation_printer', 'Professional_competitive_mahjong_table', 'professional_cocktail_stick', 'Jungle_camouflage_uniform', 'Northeast_dumplings', 'Dongpo_gifted_meat', 'Dongpo_pork', 'Dongbi_longan', 'Oriental_Leaf', 'Oriental_leaf_black_tea', 'Dongfang_leaf_green_tea', 'Oriental_leaf_jasmine_tea', "Dongfang_leaf_green_orange_Pu'er_tea", 'Dongpeng_Da_Ka_coffee', 'Dongpeng_Special_Drink', 'silk_woven_shawl', 'silk_crocheted_shawl', 'silk_warm_scarf', 'silk_embroidered_bed_sheet', 'silk_solid_color_bed_flag', 'silk_solid_color_bed_skirt', 'silk_woven_blanket', 'silk_sewing_blanket', 'silk_fabric_winter_quilt', 'Two-position_three-way_solenoid_valve', 'Two-position_five-way_solenoid_valve', 'Two-pronged_fork', 'Personal_envelope_letter', 'Personalized_custom_irregular_stool', 'Mid-position_forceps', 'Medium-voltage_power_cable', 'China_Jinjiu', 'Chinese_chess_pieces', 'Chinese_chess_pieces_Chess_and_chess_pieces', 'Chinese_chess_board', 'Medium_triangle_iron', 'Medium-sized_refrigerated_truck', 'Central_monitor', 'Central_air_conditioning', 'Central_inverter', 'Neutron_radiation_detector', 'Zhongning_wolfberry', 'Mid-top_sneakers', 'Chinese_bone_chopper', 'Center_hole_drilling_machine', 'Center_radiation_conference_table', 'Neutral_sealant', 'Neutral_water-based_pen', 'Neutral_filter_paper', 'Neutral_silicone_rubber', 'Neutrophil_detector', 'Center-hung_window', 'Viola', 'Medium_down_jacket', 'Recycled_water_reuse_system', 'Medium_silicon_carbide_brick', 'Hollow_fiber_membrane_MBR', 'Hollow_fiber_membrane_reverse_osmosis_equipment', 'Hollow_fiber_filter', 'Mid-tube_stockings', 'Mid-tube_socks', 'Mid-calf_boots', 'Mid-waist_jeans', 'Mid-waist_trousers', 'Chinese_medicine_storage_tank', 'Mid-length_cotton_jacket', 'Intermediate_sunflower_seeds', 'Zhongruan', 'Alto_tom', 'Alto_Vio', 'Fengshui_pear', 'Fenggu_wine', 'Fengxiang_strawberry', "Lin'an_sweet_potato", 'Temporary_office_desk', 'Temporary_emergency_round_stool', 'Temporary_emergency_square_stool', 'Temporary_splicing_table', 'Temporary_activity_bench', 'Temporary_dining_table', 'Linfen_beef_meatball_noodles', 'Danish_krone', 'Active_pickup', 'Host_VR_headset', 'Main_dish_plate', 'Theme_display_cabinet', 'Themed_game_table', 'Main_dinner_fork', 'Kubo_peach', 'Kubota_sake', 'Black_felt_hat_rice_wine', 'Leyuan_juice', 'Robust', 'Robust_natural_mineral_water', 'Leoho', 'Ledo_sand_fruit', 'Lego_tank', 'Lego_building_toys', 'Ping_pong', 'Table_tennis_racket', 'Table_tennis_table', 'Table_tennis_net', 'Table_tennis_net_rack', 'Joey_avocado', 'Qiaoya_coffee', 'Acetaldehyde_detector', 'Nine-ring_knife', 'Nine-pronged_pestle', 'Nine-section_whip', 'Joyoung_soy_milk', 'Emulsified_rust_inhibitor', 'Nipple_cream', 'Latex_disposable_gloves', 'Latex_seat_cushion', 'Latex_mattress', 'Latex_pillow', 'Latex_cleansing_puff', 'Latex_dishwashing_gloves', 'Latex_cleaning_gloves', 'Cream-type_sunscreen', 'Qianzhou_Guokui', '28_sauce_(28_sauce_）', 'Secondary_image_measuring_instrument', 'Secondary_ion_mass_spectrometer', 'Chlorine_dioxide_generator', 'Sulfur_dioxide_detector', 'Sulfur_dioxide_monitor', 'Carbon_dioxide_partial_pressure_analyzer', 'Carbon_dioxide_incubator', 'Carbon_dioxide_detector', 'Carbon_dioxide_detector', 'Carbon_dioxide_fire_extinguisher', 'Carbon_dioxide_monitor', 'Secondary_ankle_support', 'QR_code', 'Two-pronged_pestle', 'Erdu_Yangmei', 'Wonton_noodles', 'Cloud_observation_instrument', 'Yunzhe', 'Cloud_gong', 'Yunwu_Bay_wine', 'Cloud_height_meter', 'Yuneec_Typhoon_H_drone', 'Five-string_willow_harp', 'Five-string_pipa', 'Five-string_bass', 'Five-finger_socks', 'Five-grain_rice_dumplings', 'Five-axis_machining_center', 'Five-axis_cutting_machine', 'Five-proof_label_paper', 'Five-tooth_flying_fish_fork', 'Well_salt', 'Asian_hazelnut', 'Asian_coriander_potted_plant', 'Aliot_CID5000_fingerprint_collector', 'Sodium_nitrite', 'Linen_pillow', 'Linen_scarf_tie', 'Linen_knitted_shawl', 'Linen_scarf_tie', 'Cross-strap_shirt', 'Cross-string_harp', 'Cross_elastic_headband', 'Symphony_organ', 'AC_current_clamp_meter', 'AC/DC_clamp_meter', 'Cross-linked_polyethylene_(PEX)_aluminum-plastic_composite_pipe', 'Cross-angle_stereoscopic_slit_lamp_microscope', 'Traffic_noise_monitor', 'Transportation_vehicle-mounted_intercom', 'Postpartum_care_pad', 'Postpartum_care_solution', 'Postpartum_belly_belt', 'Maternity_sanitary_napkin', 'Maternity_pad', 'Henry_Morgan_Morgan)_black_pepper', "Henry's_Gin", 'Heinz_Noodle_Sauce', 'Heinz_Sauces_HEINZ_mustard_sauce', 'Jing_ethnic_bamboo_clapper', 'Beijing_cymbals', 'Jingyun_drum', 'Hydrophilic_colloid_dressing', 'Ergonomic_office_chair', 'Ergonomic_study_chair', 'Manually_driven_transport_vehicle', 'Ginseng_fruit', 'Remy_Martin_brandy', 'Synthetic_absorbable_suture_(PGA)_(third_generation)', 'Manual_feeding_shredder', 'RMB', 'Character_painting_wall_decoration', 'Character-shaped_Christmas_decoration_toys', 'Character-shaped_wood_carving_toys', 'Artificial_cultural_stone', 'Artificial_board_wall-mounted_bathroom_cabinet', 'Artificial_amber_ornaments', 'Artificial_fiber_scarf_tie', 'Artificial_turf_hockey_goal', 'Artificial_diamond_ring', 'Artificial_diamond_brooch', 'Artificial_Leather_flat_buckle_belt', 'Artificial_leather_automatic_sliding_buckle_belt', 'Artificial_leather_pin_buckle_belt', 'Warehousing_and_logistics_handheld_scanner', 'Storage_cage', 'Warehouse_Cage', 'Warehouse_shelves', 'Algebraist_coffee', 'Metabolite_and_small_molecule_detector', 'Israeli_shekel', 'Instrument_and_equipment_moisture-proof_cabinet', 'Zhongni_Guqin', 'Zhongjing_Food_Chili_Oil', 'Antique_craft_commemorative_coins', 'Antique_flower_tiles', 'Imitation_gemstone_brooch', 'Imitation_crystal_bracelet', 'Imitation_crystal_bracelet', 'Imitation_jade_ornaments', 'Imitation_amber_pendant', 'Imitation_amber_necklace', 'Simulation_doll', 'Simulated_plant_wall_decoration', 'Yili_yogurt', 'Yili_walnut_milk', 'Yili_Zhixuan_oat_milk_Checked', 'Yili_Meiyitian_lactic_acid_bacteria', 'Yili_Changyi_100%_lactic_acid_bacteria', 'Yili_pure_milk', 'Yili_yogurt', 'Ike_Spring_Mineral_Water', 'Yilittequ_Liquor', 'Iraqi_dinar', 'Iranian_Rial', 'Yiran_passion_fruit_flavored_sparkling_water', 'Yiran_honey_grapefruit_Corona_flavored_sparkling_water', 'Yiran_cucumber_flavored_sparkling_water', 'Itoen_barley_tea', 'Itoen_matcha_milk_tea', 'Itoen_green_tea', 'ENO_metronome', 'Wuzi_drunk_betel_nut', 'Woodford_Collection_Whisky', 'Vodka', 'Fuxi-style_guqin', 'Leisure_straight_sofa', 'Leisure_rocking_chair', 'Leisure_messenger_bag', 'Leisure_comfortable_square_stool', 'Casual_pants', 'Casual_roller_skates', 'Leisure_bar_stool', 'Leisure_mahjong_table', 'Youguan_fluorescent_bracelet', 'Kuaijishan_Yellow_Wine', 'Perineal_douche', 'Umbrella', 'Sensor_enhanced_insulin_pump', 'Traditional_character_ornament', 'Traditional_animal-shaped_pet_plush_toys', 'Traditional_craft_sesame_paste', 'Traditional_mattress', 'Traditional_bow', 'Traditional_mechanical_rice_cooker', 'Traditional_cooking_wok_spatula', 'Traditional_vertical_candlestick', 'Traditional_paper_umbrella', 'Traditional_old-fashioned_leg_press', 'Traditional_style_straight_sofa', 'Traditional_black_vinyl_record', 'Conveyor_sorter', 'Mr._Brown_coffee', 'Lingguan_style_guqin', 'Servo_punch', 'Servo_press', 'Servo_electric_bending_machine', 'Kashgar_melon', 'Low-position_forceps', 'Low_power_car_radio_station', 'Low-voltage_fuse', 'Low-voltage_linear_voltage_regulator', 'Low-voltage_isolating_switch', 'Low-noise_pet_shaver', 'Low-noise_manual_shredder', 'Low-noise_electric_eraser', 'Low-top_work_shoes', 'Low-top_sneakers', 'Low-top_Jiefang_shoes', 'Low-strain_method_testing_equipment', 'Low_emission_machine', 'Low-spin_discus', 'Low_odor_eraser', 'Low_odor_bottle_decoration_correction_fluid', 'Low_odor_pen_correction_fluid', 'Low-temperature_cold_dryer', 'Low_temperature_incubator', 'Low-temperature_foam_board', 'Low-temperature_polyurethane_insulation_board', 'Low-salt_and_fishy_shrimp_paste', 'Low_silicon_carbide_content_brick', 'Low-waist_jeans', 'Low-waisted_trousers', 'Low_sodium_salt', 'Low-damping_rubber_pad', 'Bass_Ruan', 'Low-frequency_electric_pulse_cervical_massager', 'Low_frequency_pulse_therapy_device', 'Low_frequency_pulse_therapy_device', 'Zuoxiangyuan_soybean_paste', 'Gymnastics_stick', 'Residual_chlorine_detector', 'Chayote', 'Florentine_biscuits', 'Buddha_belly_bamboo_potted_plant', 'Dong_ethnic_embroidered_shoes', 'Dong_flute', 'Evian_natural_mineral_spring_Water', 'Evian_mineral_water', 'Evian_pure_water', 'Ibaner_musical_instrument_picks', 'E-energy_lemon_juice', 'Reconnaissance_aircraft_assembly', 'Side_suction_range_hood', 'Side_suction_modular_integrated_stove', 'Side_spray_shower', 'Side_hole_type_saliva_suction_tube', 'Portable_telescopic_ladder', 'Portable_envelope_folder', 'Portable_power_bank', 'Portable_optical_theodolite', 'Portable_color_palette', 'Portable_cutting_machine', 'Portable_cutting_pen', 'Portable_lettering_pen', 'Portable_single-head_correction_tape', 'Portable_pressure_gauge', 'Portable_vacuum_cleaner', 'Portable_dough_mixer', 'Portable_inkjet_printer', 'Portable_paint_sprayer', 'Portable_sprayer', 'Portable_ballpoint_pen', 'Portable_pet_shaver', 'Portable_small_saw', 'Portable_differential_pressure_gauge', 'Portable_flat_palette', 'Portable_LCD_projector', 'Portable_LCoS_projector', 'Portable_LED_projector', 'Portable_POS_machine', 'Portable_multimeter', 'Portable_irregular_stool', 'Portable_fresh-keeping_box', "Portable_children's_study_table", 'Portable_inflator_and_deflation_machine', 'Portable_inflator_and_deflation_pump', 'Portable_inflator', 'Portable_ice_hockey_goal', 'Portable_purifier', 'Portable_office_desk', 'Portable_satellite_phone', 'Portable_suction_device', 'Portable_platform_scale', 'Portable_small_speaker', 'Portable_display_rack', 'Portable_tool_cabinet', 'Portable_bedside_table', 'Portable_electrocardiograph', 'Portable_first_aid_kit', 'Portable_manual_cleaning_machine', 'Portable_hole_puncher', 'Portable_air_pump', 'Portable_splicing_table', 'Portable_radio', 'Portable_square_stool', 'Portable_radio', 'Portable_dressing_table', 'Portable_oxygen_generator', 'Portable_oxygen_cylinder', 'Portable_game_table', 'Portable_candlestick', 'Portable_fuel_generator', 'Portable_fuel_heater', 'Portable_dental_chair', 'Portable_electronic_scale', 'Portable_electric_heater', 'Portable_TV_cabinet', 'Portable_electric_saw', 'Portable_mobile_power_supply', 'Portable_air_conditioner', 'Portable_insulation_tester', 'Portable_sewing_machine', 'Portable_steam_cleaner', 'Portable_facial_steamer', 'Portable_blood_storage_box', 'Portable_angle_grinder', 'Portable_tuner', 'Portable_mini_rice_cooker', 'Portable_wine_rack', 'Portable_audio_MP3_player', 'Portable_first_aid_kit', 'Portable_outdoor_chair', 'Portable_handheld_spray_gun', 'Portable_handheld_nail_remover', 'Portable_whisk', 'Portable_grinding_machine', 'Portable_egg_beater', 'Portable_buckle_file_bag', 'Portable_folding_folder', 'Portable_drawer_folder', 'Portable_blender', 'Portable_window_cleaner', 'Portable_digital_copier', 'Portable_incline_meter', 'Portable_barometer', 'Portable_level', 'Portable_watercolor_pen', 'Portable_gouache_brush', 'Portable_pressure_sensor', 'Portable_micrometer', 'Portable_rangefinder', 'Portable_speedometer', 'Portable_thermometer', 'Portable_temperature_and_humidity_recorder', 'Portable_vernier_caliper', 'Portable_laser_copier', 'Portable_ignition_stick', 'Portable_spot_welding_machine', 'Portable_thermal_sublimation_printer', 'Portable_thermal_printer', 'Portable_hot_air_gun', 'Portable_welding_machine', 'Portable_welding_robot', 'Portable_welding_gun', 'Portable_flint_lighter', 'Portable_power_meter', 'Portable_electric_eraser', 'Portable_voltmeter', 'Portable_arc_igniter', 'Portable_ammeter', 'Portable_welding_tongs', 'Portable_electric_hammer', 'Portable_electric_pick', 'Portable_grinding_wheel_machine', 'Portable_grinder', 'Portable_knife_sharpener', 'Portable_red_light_pen', 'Portable_cable_cutter', 'Portable_thread-bound_book', 'Portable_network_cable_checker', 'Portable_network_tester', 'Portable_wool_shears', 'Portable_backpack_tool_kit', 'Portable_waist_bag_tool_bag', 'Portable_automatic_pencil', 'Portable_highlighter', 'Portable_binding_machine', 'Portable_color_mixing_cup', 'Portable_color_palette', 'Portable_cocktail_stick', 'Portable_sealed_file_bag', 'Portable_tachometer', 'Portable_liquor_flask', 'Portable_needle_punch_Printing_machine', 'Portable_nail_Gun', 'Portable_clock', 'Portable_steel_wool', 'Portable_steel_ruler', 'Portable_drilling_machine', 'Portable_shovel', 'Portable_spatula', 'Portable_shovel', 'Portable_file_machine', 'Portable_hammer_drill', 'Portable_shovel', 'Portable_pickaxe', 'Portable_invisible_pen', 'Portable_interlayer_tool_box', 'Portable_color_measuring_instrument', 'Portable_anemometer', 'Portable_nose_hair_trimmer', 'Notepad', 'Auger_electron_spectrometer', 'Russian_ruble', 'Russian_checkers', 'Qiaoya_Dieshi_fruit_wine', 'Bulgarian_Lev', 'Protective_parts', 'Protector', 'Protection_switch_box', 'Warm_underwear', 'Warm_scarf', 'Warm_pet_nest', 'Warm_headscarf', 'Warm_pet_bed', 'Warm_gloves', 'Warm_leggings', 'Warm_shoe_covers', 'Heat_preservation_and_heating_function_emergency_blanket', 'Insulated_rock_wool_sandwich_panel', 'Thermos_cup', 'Insulated_water_bottle', 'Thermos', 'Insulated_door_curtain', 'Insulated_food_bag', 'Insulated_rice_bowl', 'Insulated_fish_box', 'Moisturizing_lotion', 'Moisturizing_gel', 'Moisturizing_spray', 'Moisturizing_care_cream', 'Moisturizing_and_nourishing_care_spray', 'Moisturizing_and_nourishing_care_cream', 'Moisturizing_products', 'Moisturizing_Facial_mask', 'Moisturizing_cream', 'Safety_cabinet', 'Safe', 'Fresh-keeping_box', 'Cling_film', 'Envelope_pillowcases', 'Envelope_paper', 'Credit_cards', 'Letter_paper', 'Repair_gel', 'Trauma_repair_care_cream', 'Repair_essence', 'Pruning_saws', 'Correction_tape', 'Correction_fluid', 'Correction_pens', 'Eyebrow_razor', 'Slim_leggings', 'Push-up_stand', 'Double_bass_viola', 'Bejiaxi_pure_milk', 'Octave_noise_meter', 'Barbed_hook', 'Back_pedal_machine', 'Debit_card', 'Incline_treadmill', 'Tilt_wheelchair', 'Fitness_gloves', "Children's_toothbrush", "Children's_badminton_racket", "Children's_sunscreen", "Children's_invisible_pen", 'Yuanqi_Forest_Sea_Salt_Coconut_Flavor_Soda', 'Yuanqi_Forest_Lychee_Flavor_Soda', 'Inflatable_bouncing_ball', 'Inflatable_tire_pressure_gauge', 'Rechargeable_shaver', 'Rechargeable_hair_remover', 'Rechargeable_pet_shaver', 'Rechargeable_flashlight', 'Rechargeable_hair_clipper', 'Rechargeable_wool_shears', 'Rechargeable_lighter', 'Optical_microscope', 'Glossy_printing_paper', 'Full-size_cello', 'Full-finger_tactical_gloves', 'Eight-treasure_Zongzi', 'Hexagonal_Erhu', 'Hexagonal_pencil', 'Hexagonal_nut', 'Ice_skates', 'Shock-absorbing_insoles', 'Shock-absorbing_insoles', 'Labor_protection_sleeves', 'Work_shoes', 'Work_shoes', 'Clarinet', 'Sweatshirt', 'Compression_socks', 'Chef_anti-slip_shoes', 'Roller_skates', 'Luminous_ice_and_snow_shoes', 'Luminous_shoes', 'Classical_guitar', 'Suspender_style_jumpsuit', 'Harem_casual_pants', 'Inkjet_copier', 'Tank_model_toy', 'Basic_function_electric_kettle', 'wall-mounted_bathroom_cabinet', 'Corded_fixed-line_phone_with_hands-free_function', 'Swing_door', 'Tray', 'Massage_chair', 'Digital_thermometer', 'Corded_landline', 'Durian', 'Folk_guitar', 'Crystal_head', 'Laser_hair_removal_device', 'Lamp_holder', 'Ball_sports_glasses', 'Electronic_keyboard', 'Pepsi_Cola_Taiqi_White_Grapefruit_Green_Bamboo_Flavor', 'Pepsi_Cola_Taiqi_White_Peach_Oolong_Flavor', 'Straight-bar_phone', 'Silicone_kneading_board', 'Bamboo_pot_brush', 'Purple_onion', 'Insulating_tape', 'Flip-top_integrated_stove', 'Polypropylene_pipe', 'PVC_tube', 'Metronome', 'Mongolian_horse-head_fiddle', 'Sitar', 'Police_multi-functional_vest', 'Police_flashlight', 'Police_infrared_thermal_imager', 'Police_alcohol_tester', 'police_riot_helmet', 'Beqi_wild_vegetable_juice', 'Wiring_tube', 'Spicy_pork_noodles', 'Sports_shoes', 'Chongqing_noodles', 'hinge', 'Polymer_waterproof_membrane', 'Dragon_head_horse_head_fiddle', 'Dragon_horse_horse_head_fiddle']
}

# 2. Register custom train dataset.
register_custom_ovd_instances(
    "custom_train_ovd_unipro",  # dataset_name
    meta_info,
    "/home/mappland/project/OV-DINO/all_data4/english-data-25-5-10.json",  # annotations_json_file
    "/home/mappland/project/OV-DINO/all_data4",  # image_root
    959,  # number_of_classes You also need to change model.num_classes in the ovdino/projects/ovdino/configs/ovdino_swin_tiny224_bert_base_ft_custom_24ep.py#L37.
    "full",  # template, default: full
)

# 3. Register custom val dataset.
register_custom_ovd_instances(
    "custom_val_ovd_unipro",
    meta_info,
    "/home/mappland/project/OV-DINO/all_data4/english-data-25-5-10.json",  # annotations_json_file
    "/home/mappland/project/OV-DINO/all_data4",  # image_root
    959,
    "full",
)
# # 4. Optional, register custom test dataset.
# register_custom_ovd_instances(
#     "custom_test_ovd",
#     meta_info,
#     "/path/to/test.json",
#     "/path/to/test/images",
#     2,
#     "full",  # choices: ["identity", "simple", "full"]
# )

dataloader.train = L(build_detection_train_loader)(
    dataset=L(get_detection_dataset_dicts)(names="custom_train_ovd_unipro"),
    mapper=L(DetrDatasetMapper)(
        augmentation=[
            L(T.RandomFlip)(),
            L(T.ResizeShortestEdge)(
                short_edge_length=(
                    480,
                    512,
                    544,
                    576,
                    608,
                    640,
                    672,
                    704,
                    736,
                    768,
                    800,
                ),
                max_size=1333,
                sample_style="choice",
            ),
        ],
        augmentation_with_crop=[
            L(T.RandomFlip)(),
            L(T.ResizeShortestEdge)(
                short_edge_length=(400, 500, 600),
                sample_style="choice",
            ),
            L(T.RandomCrop)(
                crop_type="absolute_range",
                crop_size=(384, 600),
            ),
            L(T.ResizeShortestEdge)(
                short_edge_length=(
                    480,
                    512,
                    544,
                    576,
                    608,
                    640,
                    672,
                    704,
                    736,
                    768,
                    800,
                ),
                max_size=1333,
                sample_style="choice",
            ),
        ],
        is_train=True,
        mask_on=False,
        img_format="RGB",
    ),
    total_batch_size=16,
    num_workers=4,
)

dataloader.test = L(build_detection_test_loader)(
    dataset=L(get_detection_dataset_dicts)(
        names="custom_val_ovd_unipro", filter_empty=False
    ),
    mapper=L(DetrDatasetMapper)(
        augmentation=[
            L(T.ResizeShortestEdge)(
                short_edge_length=800,
                max_size=1333,
            ),
        ],
        augmentation_with_crop=None,
        is_train=False,
        mask_on=False,
        img_format="RGB",
    ),
    num_workers=4,
)

dataloader.evaluator = L(COCOEvaluator)(
    dataset_name="${..test.dataset.names}",
)
